!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="02b4b54d-69e6-4aca-85aa-2fe3485a9bdb",e._sentryDebugIdIdentifier="sentry-dbid-02b4b54d-69e6-4aca-85aa-2fe3485a9bdb")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7293,8426],{12615:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var o=n(80263),l=n(77877),a=n(59153),i=n.n(a),r=n(73969),s=n(12862),c=n(97872),d=n(60709),u=n(32144),m=n(80251),f=n(17613),h=n(96557),g=n(81979),p=n(32036),y=n(86118),x=n(52723);async function b(e){let{projectRef:t,connectionString:n,table:o,filters:l,roleImpersonationState:a}=e,i=(0,g.Nf)(function(e){var t;let{table:n,filters:o}=e,l=new f.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return o.filter(e=>e.value&&""!==e.value).forEach(e=>{let t=(0,x.b)(n,e);l=l.filter(e.column,e.operator,t)}),l.toSql()}({table:o,filters:l}),a),{result:r}=await (0,h.E)({projectRef:t,connectionString:n,sql:i,isRoleImpersonationEnabled:(0,p._c)(null==a?void 0:a.role)});return r}let v=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,u.jE)();return(0,m.n)(e=>b(e),{async onSuccess(t,n,l){let{projectRef:a,table:i}=n;await o.invalidateQueries(y.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(t,n,l))},async onError(e,n,o){void 0===t?r.oR.error("Failed to delete all table rows: ".concat(e.message)):t(e,n,o)},...n})};var j=n(63720),w=n(23992);async function D(e){let{projectRef:t,connectionString:n,table:o,rows:l,roleImpersonationState:a}=e,i=(0,g.Nf)(function(e){var t;let{table:n,rows:o}=e,{primaryKeys:l,error:a}=(0,x.j)({table:n});if(a)throw a;let i=new f.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return null==l||l.forEach(e=>{let t=o.map(t=>t[e]);i=i.filter(e,"in",t)}),i.toSql()}({table:o,rows:l}),a),{result:r}=await (0,h.E)({projectRef:t,connectionString:n,sql:i,isRoleImpersonationEnabled:(0,p._c)(null==a?void 0:a.role)});return r}let C=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,u.jE)();return(0,m.n)(e=>D(e),{async onSuccess(t,n,o){let{projectRef:a,table:i}=n;await l.invalidateQueries(y.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(t,n,o))},async onError(e,n,l){if(void 0===t){let{table:t,rows:l}=n,a=e.message.includes("Please add a primary key column"),i=e.message.includes("violates foreign key constraint"),s=l.length>1;if(i){let n=t.name,l=e.message.split("on table ")[2].replaceAll('"',""),a=e.message.split("foreign key constraint")[1].split("on table")[0].replaceAll('"',""),i=s?"Unable to delete rows as one of them is currently referenced by a foreign key constraint from the table `".concat(l,"`."):"Unable to delete row as it is currently referenced by a foreign key constraint from the table `".concat(l,"`."),c="Set an on delete behavior on the foreign key relation `".concat(a,"` in the `").concat(l,"` table to automatically respond when row(s) are being deleted in the `").concat(n,"` table.");(0,r.oR)(i,{description:(0,o.jsx)(j.o,{content:c,className:"[&>p]:m-0"}),action:(0,o.jsx)("div",{className:"w-full flex gap-x-2 !mx-0 mt-3",children:(0,o.jsx)(w.A,{href:"https://supabase.com/docs/guides/database/postgres/cascade-deletes"})})})}else a?(0,r.oR)("Unable to delete row(s) as table has no primary keys",{description:(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)(w.A,{href:"https://supabase.com/docs/guides/database/tables#primary-keys"})})]})}):r.oR.error("Failed to delete table row: ".concat(e.message))}else t(e,n,l)},...n})};async function S(e){let{projectRef:t,connectionString:n,table:o}=e,l=function(e){var t;let{table:n}=e;return new f.Query().from(n.name,null!=(t=n.schema)?t:void 0).truncate().toSql()}({table:o}),{result:a}=await (0,h.E)({projectRef:t,connectionString:n,sql:l});return a}let A=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,u.jE)();return(0,m.n)(e=>S(e),{async onSuccess(t,n,l){let{projectRef:a,table:i}=n;await o.invalidateQueries(y.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(t,n,l))},async onError(e,n,o){void 0===t?r.oR.error("Failed to truncate table row: ".concat(e.message)):t(e,n,o)},...n})};var N=n(69817),k=n(39321),E=n(65511),R=n(70324),_=n(71126),L=n(64540);let T=e=>{var t,n,a,u,m,f,h,g,y;let{selectedTable:x,onTableDeleted:b}=e,{project:j}=(0,c.Om)(),w=(0,k.ap)(),{filters:D,onApplyFilters:S}=(0,s.M)(),T=e=>{let{columnName:t}=e;S(D.filter(e=>e.column!==t))},{mutate:I}=(0,d.T)({onSuccess:()=>{var e;if((null==(e=w.confirmationDialog)?void 0:e.type)!=="column")return;let t=w.confirmationDialog.column;T({columnName:t.name}),r.oR.success('Successfully deleted column "'.concat(t.name,'"'))},onError:e=>{var t;if((null==(t=w.confirmationDialog)?void 0:t.type)!=="column")return;let n=w.confirmationDialog.column;r.oR.error("Failed to delete ".concat(n.name,": ").concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:F}=(0,N.A)({onSuccess:async()=>{r.oR.success('Successfully deleted table "'.concat(null==x?void 0:x.name,'"')),null==b||b()},onError:e=>{r.oR.error("Failed to delete ".concat(null==x?void 0:x.name,": ").concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:q,isLoading:M}=C({onSuccess:()=>{var e,t,n;(null==(e=w.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=w.confirmationDialog).callback)||t.call(n)),r.oR.success("Successfully deleted selected row(s)")},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:Q,isLoading:W}=v({onSuccess:()=>{var e,t,n;(null==(e=w.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=w.confirmationDialog).callback)||t.call(n)),r.oR.success("Successfully deleted selected rows")},onError:e=>{r.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),{mutate:z,isLoading:O}=A({onSuccess:()=>{var e,t,n;(null==(e=w.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=w.confirmationDialog).callback)||t.call(n)),r.oR.success("Successfully deleted all rows from table")},onError:e=>{r.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{w.closeConfirmationDialog()}}),P=(null==(t=w.confirmationDialog)?void 0:t.type)==="row"&&w.confirmationDialog.allRowsSelected,$=(null==(n=w.confirmationDialog)?void 0:n.type)==="row"?w.confirmationDialog.allRowsSelected?null!=(y=w.confirmationDialog.numRows)?y:0:w.confirmationDialog.rows.length:0,H=((null==(a=w.confirmationDialog)?void 0:a.type)==="column"||(null==(u=w.confirmationDialog)?void 0:u.type)==="table")&&w.confirmationDialog.isDeleteWithCascade,X=async()=>{var e;if((null==(e=w.confirmationDialog)?void 0:e.type)!=="column"||void 0===j)return;let t=w.confirmationDialog.column;void 0!==t&&I({column:t,cascade:H,projectRef:j.ref,connectionString:null==j?void 0:j.connectionString})},U=async()=>{var e;(null==(e=w.confirmationDialog)?void 0:e.type)==="table"&&void 0!==x&&F({projectRef:null==j?void 0:j.ref,connectionString:null==j?void 0:j.connectionString,id:x.id,name:x.name,schema:x.schema,cascade:H})},B=(0,p.Qj)(),G=async()=>{var e;if(!j)return console.error("Project ref is required");if(!x)return console.error("Selected table required");if((null==(e=w.confirmationDialog)?void 0:e.type)!=="row")return;let t=w.confirmationDialog.rows;if(w.confirmationDialog.allRowsSelected)if(0===D.length){if(void 0!==B().role)return w.closeConfirmationDialog(),r.oR.error("Table truncation is not supported when impersonating a role");z({projectRef:j.ref,connectionString:j.connectionString,table:x})}else Q({projectRef:j.ref,connectionString:j.connectionString,table:x,filters:D,roleImpersonationState:B()});else q({projectRef:j.ref,connectionString:j.connectionString,table:x,rows:t,roleImpersonationState:B()})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.A,{variant:"destructive",size:"small",visible:(null==(m=w.confirmationDialog)?void 0:m.type)==="column",title:'Confirm deletion of column "'.concat((null==(f=w.confirmationDialog)?void 0:f.type)==="column"&&w.confirmationDialog.column.name,'"'),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{w.closeConfirmationDialog()},onConfirm:X,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected column? This action cannot be undone."}),(0,o.jsx)(E.A,{label:"Drop column with cascade?",description:"Deletes the column and its dependent objects",checked:H,onChange:()=>w.toggleConfirmationIsWithCascade(),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),H&&(0,o.jsxs)(R.Fc,{variant:"warning",title:"Warning: Dropping with cascade may result in unintended consequences",children:[(0,o.jsx)(R.XL,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,o.jsx)(R.TN,{children:(0,o.jsx)(_.$,{asChild:!0,size:"tiny",type:"default",icon:(0,o.jsx)(l.A,{}),children:(0,o.jsx)(i(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,o.jsx)(L.A,{variant:"destructive",size:"small",visible:(null==(h=w.confirmationDialog)?void 0:h.type)==="table",title:(0,o.jsx)("span",{className:"break-words",children:'Confirm deletion of table "'.concat(null==x?void 0:x.name,'"')}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{w.closeConfirmationDialog()},onConfirm:U,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected table? This action cannot be undone."}),(0,o.jsx)(E.A,{label:"Drop table with cascade?",description:"Deletes the table and its dependent objects",checked:H,onChange:()=>w.toggleConfirmationIsWithCascade(!H),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),H&&(0,o.jsxs)(R.Fc,{variant:"warning",children:[(0,o.jsx)(R.XL,{children:"Warning: Dropping with cascade may result in unintended consequences"}),(0,o.jsx)(R.TN,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,o.jsx)(R.TN,{className:"mt-4",children:(0,o.jsx)(_.$,{asChild:!0,size:"tiny",type:"default",icon:(0,o.jsx)(l.A,{}),children:(0,o.jsx)(i(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,o.jsx)(L.A,{variant:"destructive",size:"small",visible:(null==(g=w.confirmationDialog)?void 0:g.type)==="row",title:(0,o.jsxs)("p",{className:"break-words",children:[(0,o.jsx)("span",{children:"Confirm to delete the selected row"}),(0,o.jsx)("span",{children:$>1&&"s"})]}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>w.closeConfirmationDialog(),onConfirm:()=>G(),loading:O||M||W,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,o.jsx)("div",{className:"space-y-4",children:(0,o.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,o.jsx)("span",{children:"Are you sure you want to delete "}),(0,o.jsxs)("span",{children:[P?"all":"the selected"," "]}),(0,o.jsx)("span",{children:$>1&&"".concat($," ")}),(0,o.jsx)("span",{children:"row"}),(0,o.jsx)("span",{children:$>1&&"s"}),(0,o.jsx)("span",{children:"? This action cannot be undone."})]})})})]})}},13495:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var o=n(80263),l=n(60045),a=n(97872),i=n(46610),r=n(69636),s=n(77227),c=n(95319),d=n(25321),u=n(82008),m=n(39321);let f=e=>{var t,n;let{}=e,f=(0,m.ap)(),{selectedSchema:h}=(0,d.k)(),g=u.i.includes(h),p=(0,s.SE)(l.aG.TENANT_SQL_ADMIN_WRITE,"tables")&&!g,[y]=(0,c.M)("table-editor-sort","alphabetical"),{project:x}=(0,a.Om)(),{data:b}=(0,r.kD)({projectRef:null==x?void 0:x.ref,connectionString:null==x?void 0:x.connectionString,schemas:[h],sort:y}),v=null!=(n=null==b||null==(t=b.pages)?void 0:t[0].data.count)?n:0;return(0,o.jsx)("div",{className:"w-full h-full flex items-center justify-center","data-sentry-component":"EmptyState","data-sentry-source-file":"EmptyState.tsx",children:0===v?(0,o.jsx)(i.A,{title:"Table Editor",ctaButtonLabel:p?"Create a new table":void 0,onClickCta:p?f.onAddTable:void 0,children:(0,o.jsx)("p",{className:"text-sm text-foreground-light",children:"There are no tables available in this schema."})}):(0,o.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,o.jsx)(i.A,{title:"Table Editor",ctaButtonLabel:p?"Create a new table":void 0,onClickCta:p?f.onAddTable:void 0,children:(0,o.jsxs)("p",{className:"text-sm text-foreground-light",children:["Select a table from the navigation panel on the left to view its data",p&&", or create a new one."]})})})})}},26470:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});let o=(0,n(23983).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},39406:(e,t,n)=>{"use strict";n.d(t,{H:()=>o.A}),n(13495);var o=n(99599)},46610:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var o=n(80263),l=n(77877),a=n(41370),i=n(59153),r=n.n(i),s=n(71126);let c=e=>{let{title:t="",size:n="medium",children:i,ctaButtonLabel:c="",infoButtonLabel:d="",infoButtonUrl:u="",onClickCta:m=()=>{},loading:f=!1,disabled:h=!1,disabledMessage:g="",ctaUrl:p}=e,y=c&&m||u&&d;return(0,o.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,o.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,o.jsx)("div",{className:"flex flex-col",children:(0,o.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,o.jsx)("h5",{className:"text-foreground",children:t}),(0,o.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:i}),y&&(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&p?(0,o.jsx)(s.$,{asChild:!0,type:"primary",children:(0,o.jsx)(r(),{href:p,children:c})}):c&&m?(0,o.jsx)(a.G,{type:"primary",onClick:m,loading:f,disabled:f||h,tooltip:{content:{side:"bottom",text:h&&g.length>0?g:void 0}},children:c}):null,u&&d?(0,o.jsx)(s.$,{type:"default",icon:(0,o.jsx)(l.A,{strokeWidth:1.5}),children:(0,o.jsx)("a",{target:"_blank",rel:"noreferrer",href:u,children:d})}):null]})]})})})})}},66785:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/tables/[id]",function(){return n(84127)}])},78777:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});let o=(0,n(23983).A)("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]])},84127:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var o=n(80263),l=n(19898),a=n(95584),i=n(39406),r=n(12615),s=n(25549),c=n(1053),d=n(97872),u=n(40402),m=n(76448),f=n(49015),h=n(42592),g=n(66915),p=n(39321),y=n(8246),x=n(49655);let b=()=>{var e;let t=(0,p.ap)(),{id:n}=(0,l.g)(),s=n?Number(n):void 0,{project:c}=(0,d.Om)(),{data:b,isLoading:v}=(0,f.Pk)({projectRef:null==c?void 0:c.ref,connectionString:null==c?void 0:c.connectionString,id:s});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"[id].tsx",children:(0,o.jsx)(u.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"[id].tsx",children:(0,o.jsxs)("div",{className:"col-span-12 space-y-6",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)(m.M,{className:"!mb-0 !w-fit !whitespace-nowrap",title:"Database Tables","data-sentry-element":"FormHeader","data-sentry-source-file":"[id].tsx"}),(0,o.jsx)(g.A,{size:18,strokeWidth:1.5,className:"text-foreground-light","data-sentry-element":"ChevronRight","data-sentry-source-file":"[id].tsx"}),v?(0,o.jsx)(x.A,{className:"w-40"}):(0,o.jsx)(m.M,{className:"!mb-0",title:null!=(e=null==b?void 0:b.name)?e:""})]}),(0,o.jsx)(a.$e,{onAddColumn:t.onAddColumn,onEditColumn:t.onEditColumn,onDeleteColumn:t.onDeleteColumn,"data-sentry-element":"ColumnList","data-sentry-source-file":"[id].tsx"})]})})}),(null==c?void 0:c.ref)!==void 0&&void 0!==b&&(0,h.KO)(b)&&(0,o.jsxs)(y.HQ,{projectRef:null==c?void 0:c.ref,table:b,children:[(0,o.jsx)(r.A,{selectedTable:b}),(0,o.jsx)(i.H,{includeColumns:!0,selectedTable:b})]},"table-editor-table-".concat(b.id))]})};b.getLayout=e=>(0,o.jsx)(c.A,{children:(0,o.jsx)(s.A,{title:"Database",children:e})});let v=b}},e=>{var t=t=>e(e.s=t);e.O(0,[89,4335,2147,726,4669,9353,7176,3730,9844,6110,9955,6871,8153,5297,5661,4100,8870,2981,4181,2187,4560,7344,3895,1959,9116,9869,4938,5758,3902,7872,5874,49,2174,971,6642,8434,2602,99,6544,6206,6593,636,8792],()=>t(66785)),_N_E=e.O()}]);